<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • uwot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uwot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.16.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jlmelville/uwot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/jlmelville/uwot/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.16.9000" id="uwot-01169000">uwot 0.1.16.9000<a class="anchor" aria-label="anchor" href="#uwot-01169000"></a></h2>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.16" id="uwot-0116">uwot 0.1.16<a class="anchor" aria-label="anchor" href="#uwot-0116"></a></h2><p class="text-muted">CRAN release: 2023-06-29</p>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-16">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-16"></a></h3>
<ul><li>A small change to a header file was required to fully support the next version of <a href="https://cran.r-project.org/package=RcppAnnoy" class="external-link">RcppAnnoy</a>. Thank you <a href="https://github.com/eddelbuettel" class="external-link">Dirk Eddelbuettel</a> for the PR (<a href="https://github.com/jlmelville/uwot/issues/112" class="external-link uri">https://github.com/jlmelville/uwot/issues/112</a>).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.15" id="uwot-0115">uwot 0.1.15<a class="anchor" aria-label="anchor" href="#uwot-0115"></a></h2><p class="text-muted">CRAN release: 2023-06-26</p>
<div class="section level3">
<h3 id="new-features-0-1-15">New features:<a class="anchor" aria-label="anchor" href="#new-features-0-1-15"></a></h3>
<ul><li>New function: <code>optimize_graph_layout</code>. Use this to produce optimized output coordinates that reflect an input similarity graph (such as that produced by the <code>similarity_graph</code> function. <code>similarity_graph</code> followed by <code>optimize_graph_layout</code> is the same as running <code>umap</code>, so the purpose of these functions is to allow for more flexibility and decoupling between generating the nearest neighbor graph and optimizing the low-dimensional approximation to it. Based on a request by user <a href="https://github.com/Chengwei94" class="external-link">Chengwei94</a> (<a href="https://github.com/jlmelville/uwot/issues/98" class="external-link uri">https://github.com/jlmelville/uwot/issues/98</a>).</li>
<li>New functions: <code>simplicial_set_union</code> and <code>simplicial_set_intersect</code>. These allow for the combination of different fuzzy graph representations of a dataset into a single fuzzy graph using the UMAP simplicial set operations. Based on a request in the Python UMAP issues tracker by user <a href="https://github.com/ratheraarif" class="external-link">Dhar xion</a>.</li>
<li>New parameter for <code>umap_transform</code>: <code>ret_extra</code>. This works like the equivalent parameter for <code>umap</code>, and should be a character vector specifying the extra information you would like returned in addition to the embedding, in which case a list will be returned with an <code>embedding</code> member containing the optimized coordinates. Supported values are <code>"fgraph"</code>, <code>"nn"</code>, <code>"sigma"</code> and <code>"localr"</code>. Based on a request by user <a href="https://github.com/PedroMilanezAlmeida" class="external-link">PedroMilanezAlmeida</a> (<a href="https://github.com/jlmelville/uwot/issues/104" class="external-link uri">https://github.com/jlmelville/uwot/issues/104</a>).</li>
<li>New parameter from <code>umap</code>, <code>tumap</code> and <code>umap_transform</code>: <code>seed</code>. This will do the equivalent of calling <code>set.seed</code> internally, and hence will help with reproducibility. The chosen seed is exported if <code>ret_model = TRUE</code> and <code>umap_transform</code> will use that seed if present, so you only need to specify it in <code>umap_transform</code> if you want to change the seed. The default behavior remains to not modify the random number state. Based on a request by <a href="https://github.com/SuhasSrinivasan" class="external-link">SuhasSrinivasan</a> (<a href="https://github.com/jlmelville/uwot/issues/110" class="external-link uri">https://github.com/jlmelville/uwot/issues/110</a>).</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-15">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-15"></a></h3>
<ul><li>A new setting for <code>init_sdev</code>: set <code>init_sdev = "range"</code> and initial coordinates will be range-scaled so each column takes values between 0-10. This pre-processing was added to the Python UMAP package at some point after <code>uwot</code> began development and so should probably always be used with the default <code>init = "spectral"</code> setting. However, it is not set by default to maintain backwards compatibility with older versions of <code>uwot</code>.</li>
<li>
<code>ret_extra = c("sigma")</code> is now supported by <code>lvish</code>. The Gaussian bandwidths are returned in a <code>sigma</code> vector. In addition, a vector of intrinsic dimensionalities estimated for each point using an analytical expression of the finite difference method given by <a href="https://doi.org/10.1016/j.neucom.2014.12.095" class="external-link">Lee and co-workers</a> is returned in the <code>dint</code> vector.</li>
<li>The <code>min_dist</code> and <code>spread</code> parameters are now returned in the model when <code>umap</code> is run with <code>ret_model = TRUE</code>. This is just for documentation purposes, these values are not used directly by the model in <code>umap_transform</code>. If the parameters <code>a</code> and <code>b</code> are set directly when invoking <code>umap</code>, then both <code>min_dist</code> and <code>spread</code> will be set to <code>NULL</code> in the returned model. This feature was added in response to a question from <a href="https://github.com/kjiang18" class="external-link">kjiang18</a> (<a href="https://github.com/jlmelville/uwot/issues/95" class="external-link uri">https://github.com/jlmelville/uwot/issues/95</a>).</li>
<li>Some new checks for NA values in input data have been added. Also a warning will be emitted if <code>n_components</code> seems to have been set too high.</li>
<li>If <code>n_components</code> was greater than <code>n_neighbors</code> then <code>umap_transform</code> would crash the R session. Thank you to <a href="https://github.com/ChVav" class="external-link">ChVav</a> for reporting this (<a href="https://github.com/jlmelville/uwot/issues/102" class="external-link uri">https://github.com/jlmelville/uwot/issues/102</a>).</li>
<li>Using <code>umap_transform</code> with a model where <code>dens_scale</code> was set could cause a segmentation fault, destroying the session. Even if it didn’t it could give an entirely artifactual “ring” structure. Thank you <a href="https://github.com/FemkeSmit" class="external-link">FemkeSmit</a> for reporting this and providing assistance in diagnosing the underlying cause (<a href="https://github.com/jlmelville/uwot/issues/103" class="external-link uri">https://github.com/jlmelville/uwot/issues/103</a>).</li>
<li>If you set <code>binary_edge_weights = TRUE</code>, this setting was not exported when <code>ret_model = TRUE</code>, and was therefore not respected by <code>umap_transform</code>. This has now been fixed, but you will need to regenerate any models that used binary edge weights.</li>
<li>The rdoc for the <code>init</code> param said that if there were multiple disconnected components, a spectral initialization would attempt to merge multiple sub-graphs. Not true: actually, spectral initialization is abandoned in favor of PCA. The documentation has been updated to reflect the true state of affairs. No idea what I was thinking of there.</li>
<li>
<code>load_model</code> and <code>save_model</code> didn’t work on Windows 7 due to how the version of <code>tar</code> there handles drive letters. Thank you <a href="https://github.com/mytarmail" class="external-link">mytarmail</a> for the report (<a href="https://github.com/jlmelville/uwot/issues/109" class="external-link uri">https://github.com/jlmelville/uwot/issues/109</a>).</li>
<li>Warn if the initial coordinates have a very large scale (a standard deviation &gt; 10.0), because this can lead to small gradients and poor optimization. Thank you <a href="https://github.com/SuhasSrinivasan" class="external-link">SuhasSrinivasan</a> for the report (<a href="https://github.com/jlmelville/uwot/issues/110" class="external-link uri">https://github.com/jlmelville/uwot/issues/110</a>).</li>
<li>A change to accommodate a forthcoming version of <a href="https://cran.r-project.org/package=RcppAnnoy" class="external-link">RcppAnnoy</a>. Thank you <a href="https://github.com/eddelbuettel" class="external-link">Dirk Eddelbuettel</a> for the PR (<a href="https://github.com/jlmelville/uwot/issues/111" class="external-link uri">https://github.com/jlmelville/uwot/issues/111</a>).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.14" id="uwot-0114">uwot 0.1.14<a class="anchor" aria-label="anchor" href="#uwot-0114"></a></h2><p class="text-muted">CRAN release: 2022-08-22</p>
<div class="section level3">
<h3 id="new-features-0-1-14">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-14"></a></h3>
<ul><li>New function: <code>similarity_graph</code>. If you are more interested in the high-dimensional graph/fuzzy simplicial set representation of your input data, and don’t care about the low dimensional approximation, the <code>similarity_graph</code> function offers a similar API to <code>umap</code>, but neither the initialization nor optimization of low-dimensional coordinates will be performed. The return value is the same as that which would be returned in the results list as the <code>fgraph</code> member if you had provided <code>ret_extra = c("fgraph")</code>. Compared to getting the same result via running <code>umap</code>, this function is a bit more convenient to use, makes your intention clearer if you would be discarding the embedding, and saves a small amount of time. A t-SNE/LargeVis similarity graph can be returned by setting <code>method = "largevis"</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-14">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-14"></a></h3>
<ul><li>If a model was generated without using pre-generated nearest neighbors, you couldn’t use <code>umap_transform</code> with pre-generated nearest neighbors (also the error message was completely useless). Thank you to <a href="https://github.com/AustinHartman" class="external-link">AustinHartman</a> for reporting this (<a href="https://github.com/jlmelville/uwot/issues/97" class="external-link uri">https://github.com/jlmelville/uwot/issues/97</a>).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.13" id="uwot-0113">uwot 0.1.13<a class="anchor" aria-label="anchor" href="#uwot-0113"></a></h2><p class="text-muted">CRAN release: 2022-08-16</p>
<ul><li>This is a resubmission of 0.1.12 but with an internal function (<code>fuzzy_simplicial_set</code>) refactored to behave more like that of previous versions. This change was breaking the behavior of the CRAN package <a href="https://cran.r-project.org/package=bbknnR" class="external-link">bbknnR</a>.</li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.12" id="uwot-0112">uwot 0.1.12<a class="anchor" aria-label="anchor" href="#uwot-0112"></a></h2>
<div class="section level3">
<h3 id="new-features-0-1-12">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-12"></a></h3>
<ul><li>New parameter: <code>dens_weight</code>. If set to a value between 0 and 1, an attempt is made to include the relative local densities of the input data in the output coordinates. This is an approximation to the <a href="https://doi.org/10.1038/s41587-020-00801-7" class="external-link">densMAP</a> method. A large value of <code>dens_weight</code> will use a larger range of output densities to reflect the input data. If the data is too spread out, reduce the value of <code>dens_weight</code>. For more information see the <a href="https://jlmelville.github.io/uwot/leopold.html">documentation at the uwot repo</a>.</li>
<li>New parameter: <code>binary_edge_weights</code>. If set to <code>TRUE</code>, instead of smoothed knn distances, non-zero edge weights all have a value of 1. This is how <a href="https://www.jmlr.org/papers/v22/20-1061.html" class="external-link">PaCMAP</a> works and there is <a href="https://arxiv.org/abs/2007.08902" class="external-link">practical</a> and <a href="https://proceedings.neurips.cc/paper/2021/hash/2de5d16682c3c35007e4e92982f1a2ba-Abstract.html" class="external-link">theoretical</a> reasons to believe this won’t have a big effect on UMAP but you can try it yourself.</li>
<li>New options for <code>ret_extra</code>:
<ul><li>
<code>"sigma"</code>: the return value will contain a <code>sigma</code> entry, a vector of the smooth knn distance scaling normalization factors, one for each observation in the input data. A small value indicates a high density of points in the local neighborhood of that observation. For <code>lvish</code> the equivalent bandwidths calculated for the input perplexity is returned.</li>
<li>also, a vector <code>rho</code> will be exported, which is the distance to the nearest neighbor after the number of neighbors specified by the <code>local_connectivity</code>. Only applies for <code>umap</code> and <code>tumap</code>.</li>
<li>
<code>"localr"</code>: exports a vector of the local radii, the sum of <code>sigma</code> and <code>rho</code> and used to scale the output coordinates when <code>dens_weight</code> is set. Even if not using <code>dens_weight</code>, visualizing the output coordinates using a color scale based on the value of <code>localr</code> can reveal regions of the input data with different densities.</li>
</ul></li>
<li>For functions <code>umap</code> and <code>tumap</code> only: new data type for precomputed nearest neighbor data passed as the <code>nn_method</code> parameter: you may use a sparse distance matrix of format <code>dgCMatrix</code> with dimensions <code>N x N</code> where <code>N</code> is the number of observations in the input data. Distances should be arranged by column, i.e. a non-zero entry in row <code>j</code> of the <code>i</code>th column indicates that the <code>j</code>th observation in the input data is a nearest neighbor of the <code>i</code>th observation with the distance given by the value of that element. Note that this is a different format to the sparse distance matrix that can be passed as input to <code>X</code>: notably, the matrix is not assumed to be symmetric. Unlike other input formats, you may have a different number of neighbors for each observation (but there must be at least one neighbor defined per observation).</li>
<li>
<code>umap_transform</code> can also take a sparse distance matrix as its <code>nn_method</code> parameter if precomputed nearest neighbor data is used to generate an initial model. The format is the same as for the <code>nn_method</code> with <code>umap</code>. Because distances are arranged by columns, the expected dimensions of the sparse matrix is <code>N_model x N_new</code> where <code>N_model</code> is the number of observations in the original data and <code>N_new</code> is the number of observations in the data to be transformed.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-12">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-12"></a></h3>
<ul><li>Models couldn’t be re-saved after loading. Thank you to <a href="https://github.com/ilyakorsunsky" class="external-link">ilyakorsunsky</a> for reporting this (<a href="https://github.com/jlmelville/uwot/issues/88" class="external-link uri">https://github.com/jlmelville/uwot/issues/88</a>).</li>
<li>
<a href="https://cran.r-project.org/package=RSpectra" class="external-link">RSpectra</a> is now a ‘Suggests’, rather than an ‘Imports’. If you have RSpectra installed, it will be used automatically where previous versions required it (for spectral initialization). Otherwise, <a href="https://cran.r-project.org/package=irlba" class="external-link">irlba</a> will be used. For two-dimensional output, you are unlikely to notice much difference in speed or accuracy with real-world data. For highly-structured simulation datasets (e.g. spectral initialization of a 1D line) then RSpectra will give much better, faster initializations, but these are not the typical use cases envisaged for this package. For embedding into higher dimensions (e.g. <code>n_components = 100</code> or higher), RSpectra is recommended and will likely out-perform irlba even if you have installed a good linear algebra library.</li>
<li>
<code>init = "laplacian"</code> returned the wrong coordinates because of a slightly subtle issue around how to order the eigenvectors when using the random walk transition matrix rather than normalized graph laplacians.</li>
<li>The <code>init_sdev</code> parameter was ignored when the <code>init</code> parameter was a user-supplied matrix. Now the input will be scaled.</li>
<li>Matrix input was being converted to and from a data frame during pre-processing, causing R to allocate memory that it was disinclined to ever give up even after the function exited. This unnecessary manipulation is now avoided.</li>
<li>The behavior of the <code>bandwidth</code> parameter has been changed to give results more like the current version (0.5.2) of the Python UMAP implementation. This is likely to be a breaking change for non-default settings of <code>bandwidth</code>, but this is not a parameter which is actually exposed by the Python UMAP public API any more, so is on the road to deprecation in uwot too and I don’t recommend you change this.</li>
<li>Transforming data with multiple blocks would give an error if the number of rows of the new data did not equal the number of number of rows in the original data.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.11" id="uwot-0111">uwot 0.1.11<a class="anchor" aria-label="anchor" href="#uwot-0111"></a></h2><p class="text-muted">CRAN release: 2021-12-02</p>
<div class="section level3">
<h3 id="new-features-0-1-11">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-11"></a></h3>
<ul><li>New parameter: <code>batch</code>. If <code>TRUE</code>, then results are reproducible when <code>n_sgd_threads &gt; 1</code> (as long as you use <code>set.seed</code>). The price to be paid is that the optimization is slightly less efficient (because coordinates are not updated as quickly and hence gradients are staler for longer), so it is highly recommended to set <code>n_epochs = 500</code> or higher. Thank you to <a href="https://github.com/LTLA" class="external-link">Aaron Lun</a> who not only came up with a way to implement this feature, but also wrote an entire <a href="https://github.com/LTLA/umappp" class="external-link">C++ implementation of UMAP</a> which does it (<a href="https://github.com/jlmelville/uwot/issues/83" class="external-link uri">https://github.com/jlmelville/uwot/issues/83</a>).</li>
<li>New parameter: <code>opt_args</code>. The default optimization method when <code>batch = TRUE</code> is <a href="https://arxiv.org/abs/1412.6980" class="external-link">Adam</a>. You can control its parameters by passing them in the <code>opt_args</code> list. As Adam is a momentum-based method it requires extra storage of previous gradient data. To avoid the extra memory overhead you can also use <code>opt_args = list(method = "sgd")</code> to use a stochastic gradient descent method like that used when <code>batch = FALSE</code>.</li>
<li>New parameter: <code>epoch_callback</code>. You may now pass a function which will be invoked at the end of each epoch. Mainly useful for producing an image of the state of the embedding at different points during the optimization. This is another feature taken from <a href="https://github.com/LTLA/umappp" class="external-link">umappp</a>.</li>
<li>New parameter: <code>pca_method</code>, used when the <code>pca</code> parameter is supplied to reduce the initial dimensionality of the data. This controls which method is used to carry out the PCA and can be set to one of:
<ul><li>
<code>"irlba"</code> which uses <code><a href="https://rdrr.io/pkg/irlba/man/irlba.html" class="external-link">irlba::irlba</a></code> to calculate a truncated SVD. If this routine deems that you are trying to extract 50% or more of the singular vectors, you will see a warning to that effect logged to the console.</li>
<li>
<code>"rsvd"</code>, which uses <code><a href="https://rdrr.io/pkg/irlba/man/svdr.html" class="external-link">irlba::svdr</a></code> for truncated SVD. This method uses a small number of iterations which should give an accuracy/speed up trade-off similar to that of the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html#sklearn.decomposition.TruncatedSVD" class="external-link">scikit-learn TruncatedSVD</a> method. This can be much faster than using <code>"irlba"</code> but potentially at a cost in accuracy. However, for the purposes of dimensionality reduction as input to nearest neighbor search, this doesn’t seem to matter much.</li>
<li>
<code>"bigstatsr"</code>, which uses the <a href="https://cran.r-project.org/package=bigstatsr" class="external-link">bigstatsr</a> package will be used. <strong>Note</strong>: that this is <em>not</em> a dependency of <code>uwot</code>. If you want to use <code>bigstatsr</code>, you must install it yourself. On platforms without easy access to fast linear algebra libraries (e.g. Windows), using <code>bigstatsr</code> may give a speed up to PCA calculations.</li>
<li>
<code>"svd"</code>, which uses <code><a href="https://rdrr.io/r/base/svd.html" class="external-link">base::svd</a></code>. <strong>Warning</strong>: this is likely to be very slow for most datasets and exists as a fallback for small datasets where the <code>"irlba"</code> method would print a warning.</li>
<li>
<code>"auto"</code> (the default) which uses <code>"irlba"</code> to calculate a truncated SVD, unless you are attempting to extract 50% or more of the singular vectors, in which case <code>"svd"</code> is used.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-11">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-11"></a></h3>
<ul><li>If row names are provided in the input data (or nearest neighbor data, or initialization data if it’s a matrix), this will be used to name the rows of the output embedding (<a href="https://github.com/jlmelville/uwot/issues/81" class="external-link uri">https://github.com/jlmelville/uwot/issues/81</a>), and also the nearest neighbor data if you set <code>ret_nn = TRUE</code>. If the names exist in more than one of the input data parameters listed above, but are inconsistent, no guarantees are made about which names will be used. Thank you <a href="https://github.com/jwijffels" class="external-link">jwijffels</a> for reporting this.</li>
<li>In <code>umap_transform</code>, the learning rate is now down-scaled by a factor of 4, consistent with the Python implementation of UMAP. If you need the old behavior back, use the (newly added) <code>learning_rate</code> parameter in <code>umap_transform</code> to set it explicitly. If you used the default value in <code>umap</code> when creating the model, the correct setting in <code>umap_transform</code> is <code>learning_rate = 1.0</code>.</li>
<li>Setting <code>nn_method = "annoy"</code> and <code>verbose = TRUE</code> would lead to an error with datasets with fewer than 50 items in them.</li>
<li>Using multiple pre-computed nearest neighbors blocks is now supported with <code>umap_transform</code> (this was incorrectly documented to work).</li>
<li>Documentation around pre-calculated nearest neighbor data for <code>umap_transform</code> was wrong in other ways: it has now been corrected to indicate that there should be neighbor data for each item in the test data, but the neighbors and distances should refer to items in training data (i.e. the data used to build the model).</li>
<li>
<code>n_neighbors</code> parameter is now correctly ignored in model generation if pre-calculated nearest neighbor data is provided.</li>
<li>Documentation incorrectly said <code>grain_size</code> didn’t do anything.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.10" id="uwot-0110">uwot 0.1.10<a class="anchor" aria-label="anchor" href="#uwot-0110"></a></h2><p class="text-muted">CRAN release: 2020-12-15</p>
<p>This release is mainly to allow for some internal changes to keep compatibility with RcppAnnoy, used for the nearest neighbor calculations.</p>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-10">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-10"></a></h3>
<ul><li>Passing in data with missing values will now raise an error early. Missing data in factor columns intended for supervised UMAP is still ok. Thank you David McGaughey for tweeting about this issue.</li>
<li>The documentation for the return value of <code>umap</code> and <code>tumap</code> now note that the contents of the <code>model</code> list are subject to change and not intended to be part of the uwot public API. I recommend not relying on the structure of the <code>model</code>, especially if your package is intended to appear on CRAN or Bioconductor, as any breakages will delay future releases of uwot to CRAN.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.9" id="uwot-019">uwot 0.1.9<a class="anchor" aria-label="anchor" href="#uwot-019"></a></h2><p class="text-muted">CRAN release: 2020-11-15</p>
<div class="section level3">
<h3 id="new-features-0-1-9">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-9"></a></h3>
<ul><li>New metric: <code>metric = "correlation"</code> a distance based on the Pearson correlation (<a href="https://github.com/jlmelville/uwot/issues/22" class="external-link uri">https://github.com/jlmelville/uwot/issues/22</a>). Supporting this required a change to the internals of how nearest neighbor data is stored. Backwards compatibility with models generated by previous versions using <code>ret_model = TRUE</code> should have been preserved.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-9">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-9"></a></h3>
<ul><li>New parameter, <code>nn_method</code>, for <code>umap_transform</code>: pass a list containing pre-computed nearest neighbor data (identical to that used in the <code>umap</code> function). You should not pass anything to the <code>X</code> parameter in this case. This extends the functionality for transforming new points to the case where nearest neighbor data between the original data and new data can be calculated external to <code>uwot</code>. Thanks to <a href="https://github.com/yuhanH" class="external-link">Yuhan Hao</a> for contributing the PR (<a href="https://github.com/jlmelville/uwot/issues/63" class="external-link uri">https://github.com/jlmelville/uwot/issues/63</a> and <a href="https://github.com/jlmelville/uwot/issues/64" class="external-link uri">https://github.com/jlmelville/uwot/issues/64</a>).</li>
<li>New parameter, <code>init</code>, for <code>umap_transform</code>: provides a variety of options for initializing the output coordinates, analogously to the same parameter in the <code>umap</code> function (but without as many options currently). This is intended to replace <code>init_weighted</code>, which should be considered deprecated, but won’t be removed until uwot 1.0 (whenever that is). Instead of <code>init_weighted = TRUE</code>, use <code>init = "weighted"</code>; replace <code>init_weighted = FALSE</code> with <code>init = "average"</code>. Additionally, you can pass a matrix to <code>init</code> to act as the initial coordinates.</li>
<li>Also in <code>umap_transform</code>: previously, setting <code>n_epochs = 0</code> was ignored: at least one iteration of optimization was applied. Now, <code>n_epochs = 0</code> is respected, and will return the initialized coordinates without any further optimization.</li>
<li>Minor performance improvement for single-threaded nearest neighbor search when <code>verbose = TRUE</code>: the progress bar calculations were taking up a detectable amount of time and has now been fixed. With very small data sets (&lt; 50 items) the progress bar will no longer appear when building the index.</li>
<li>Passing a sparse distance matrix as input now supports upper/lower triangular matrix storage rather than wasting storage using an explicitly symmetric sparse matrix.</li>
<li>Minor license change: uwot used to be licensed under GPL-3 only; now it is GPL-3 or later.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.8" id="uwot-018">uwot 0.1.8<a class="anchor" aria-label="anchor" href="#uwot-018"></a></h2><p class="text-muted">CRAN release: 2020-03-16</p>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-8">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-8"></a></h3>
<ul><li>default for <code>n_threads</code> is now <code>NULL</code> to provide a bit more protection from changing dependencies.</li>
<li>parallel code now uses the standard C++11 implementation of threading rather than tinythread++.</li>
<li>The <code>grain_size</code> parameter has been undeprecated. As the version that deprecated this never made it to CRAN, this is unlikely to have affected many people.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.7" id="uwot-017">uwot 0.1.7<a class="anchor" aria-label="anchor" href="#uwot-017"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-7">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-7"></a></h3>
<ul><li>uwot should no longer trigger undefined behavior in sanitizers, due to the temporary replacement of the RcppParallel package with code “borrowed” from that package and using tinythread++ rather than tbb (<a href="https://github.com/jlmelville/uwot/issues/52" class="external-link uri">https://github.com/jlmelville/uwot/issues/52</a>).</li>
<li>Further sanitizer improvements in the nearest neighbor search code due to the upstream efforts of <a href="https://github.com/erikbern" class="external-link">erikbern</a> and <a href="https://github.com/eddelbuettel" class="external-link">eddelbuettel</a> (<a href="https://github.com/jlmelville/uwot/issues/50" class="external-link uri">https://github.com/jlmelville/uwot/issues/50</a>).</li>
<li>The <code>grain_size</code> parameter is now ignored and remains to avoid breaking backwards compatibility only.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.6" id="uwot-016">uwot 0.1.6<a class="anchor" aria-label="anchor" href="#uwot-016"></a></h2>
<div class="section level3">
<h3 id="new-features-0-1-6">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-6"></a></h3>
<ul><li>New parameter, <code>ret_extra</code>, a vector which can contain any combination of: <code>"model"</code> (same as <code>ret_model = TRUE</code>), <code>"nn"</code> (same as <code>ret_nn = TRUE</code>) and <code>fgraph</code> (see below).</li>
<li>New return value data: If the <code>ret_extra</code> vector contains <code>"fgraph"</code>, the returned list will contain an <code>fgraph</code> item representing the fuzzy simplicial input graph as a sparse N x N matrix. For <code>lvish</code>, use <code>"P"</code> instead of <code>"fgraph</code>” (<a href="https://github.com/jlmelville/uwot/issues/47" class="external-link uri">https://github.com/jlmelville/uwot/issues/47</a>). Note that there is a further sparsifying step where edges with a very low membership are removed if there is no prospect of the edge being sampled during optimization. This is controlled by <code>n_epochs</code>: the smaller the value, the more sparsifying will occur. If you are only interested in the fuzzy graph and not the embedded coordinates, set <code>n_epochs = 0</code>.</li>
<li>New function: <code>unload_uwot</code>, to unload the Annoy nearest neighbor indices in a model. This prevents the model from being used in <code>umap_transform</code>, but allows for the temporary working directory created by both <code>save_uwot</code> and <code>load_uwot</code> to be deleted. Previously, both <code>load_uwot</code> and <code>save_uwot</code> were attempting to delete the temporary working directories they used, but would always silently fail because Annoy is making use of files in those directories.</li>
<li>An attempt has been made to reduce the variability of results due to different compiler and C++ library versions on different machines. Visually results are unchanged in most cases, but this is a breaking change in terms of numerical output. The best chance of obtaining floating point determinism across machines is to use <code>init = "spca"</code>, fixed values of <code>a</code> and <code>b</code> (rather than allowing them to be calculated through setting <code>min_dist</code> and <code>spread</code>) and <code>approx_pow = TRUE</code>. Using the <code>tumap</code> method with <code>init = "spca"</code> is probably the most robust approach.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-6">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-6"></a></h3>
<ul><li>New behavior when <code>n_epochs = 0</code>. This used to behave like (<code>n_epochs = NULL</code>) and gave a default number of epochs (dependent on the number of vertices in the dataset). Now it more usefully carries out all calculations except optimization, so the returned coordinates are those specified by the <code>init</code> parameter, so this is an easy way to access e.g. the spectral or PCA initialization coordinates. If you want the input fuzzy graph (<code>ret_extra</code> vector contains <code>"fgraph"</code>), this will also prevent the graph having edges with very low membership being removed. You still get the old default epochs behavior by setting <code>n_epochs = NULL</code> or to a negative value.</li>
<li>
<code>save_uwot</code> and <code>load_uwot</code> have been updated with a <code>verbose</code> parameter so it’s easier to see what temporary files are being created.</li>
<li>
<code>save_uwot</code> has a new parameter, <code>unload</code>, which if set to <code>TRUE</code> will delete the working directory for you, at the cost of unloading the model, i.e. it can’t be used with <code>umap_transform</code> until you reload it with <code>load_uwot</code>.</li>
<li>
<code>save_uwot</code> now returns the saved model with an extra field, <code>mod_dir</code>, which points to the location of the temporary working directory, so you should now assign the result of calling <code>save_uwot</code> to the model you saved, e.g. <code>model &lt;- save_uwot(model, "my_model_file")</code>. This field is intended for use with <code>unload_uwot</code>.</li>
<li>
<code>load_uwot</code> also returns the model with a <code>mod_dir</code> item for use with <code>unload_uwot</code>.</li>
<li>
<code>save_uwot</code> and <code>load_uwot</code> were not correctly handling relative paths.</li>
<li>A previous bug fix to <code>load_uwot</code> in uwot 0.1.4 to work with newer versions of RcppAnnoy (<a href="https://github.com/jlmelville/uwot/issues/31" class="external-link uri">https://github.com/jlmelville/uwot/issues/31</a>) failed in the typical case of a single metric for the nearest neighbor search using all available columns, giving an error message along the lines of: <code>Error: index size &lt;size&gt; is not a multiple of vector size &lt;size&gt;</code>. This has now been fixed, but required changes to both <code>save_uwot</code> and <code>load_uwot</code>, so existing saved models must be regenerated. Thank you to reporter <a href="https://github.com/OuNao" class="external-link">OuNao</a>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.5" id="uwot-015">uwot 0.1.5<a class="anchor" aria-label="anchor" href="#uwot-015"></a></h2><p class="text-muted">CRAN release: 2019-12-04</p>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-5">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-5"></a></h3>
<ul><li>The R API was being accessed from inside multi-threaded code to seed the (non-R) random number generators. Probably this was causing users in downstream projects (seurat and monocle) to experience strange RcppParallel-related crashes. Thanks to <a href="https://github.com/aldojongejan" class="external-link">aldojongejan</a> for reporting this (<a href="https://github.com/jlmelville/uwot/issues/39" class="external-link uri">https://github.com/jlmelville/uwot/issues/39</a>).</li>
<li>Passing a floating point value smaller than one to <code>n_threads</code> caused a crash. This was particularly insidious if running with a system with only one default thread available as the default <code>n_threads</code> becomes <code>0.5</code>. Now <code>n_threads</code> (and <code>n_sgd_threads</code>) are rounded to the nearest integer.</li>
<li>Initialization of supervised UMAP should now be faster (<a href="https://github.com/jlmelville/uwot/issues/34" class="external-link uri">https://github.com/jlmelville/uwot/issues/34</a>). Contributed by <a href="https://github.com/LTLA" class="external-link">Aaron Lun</a>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.4" id="uwot-014">uwot 0.1.4<a class="anchor" aria-label="anchor" href="#uwot-014"></a></h2><p class="text-muted">CRAN release: 2019-09-23</p>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-4">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-4"></a></h3>
<ul><li>Fixed incorrect loading of Annoy indexes to be compatible with newer versions of RcppAnnoy (<a href="https://github.com/jlmelville/uwot/issues/31" class="external-link uri">https://github.com/jlmelville/uwot/issues/31</a>). My thanks to Dirk Eddelbuettel and Erik Bernhardsson for aid in identifying the problem.</li>
<li>Fix for <code>ERROR: there is already an InterruptableProgressMonitor instance defined</code>.</li>
<li>If <code>verbose = TRUE</code>, the <code>a</code>, <code>b</code> curve parameters are now logged.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.3" id="uwot-013">uwot 0.1.3<a class="anchor" aria-label="anchor" href="#uwot-013"></a></h2><p class="text-muted">CRAN release: 2019-04-07</p>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-3">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-3"></a></h3>
<ul><li>Fixed an issue where the session would crash if the Annoy nearest neighbor search was unable to find k neighbors for an item.</li>
</ul></div>
<div class="section level3">
<h3 id="known-issue-0-1-3">Known issue<a class="anchor" aria-label="anchor" href="#known-issue-0-1-3"></a></h3>
<p>Even with a fix for the bug mentioned above, if the nearest neighbor index file is larger than 2GB in size, Annoy may not be able to read the data back in. This should only occur with very large or high-dimensional datasets. The nearest neighbor search will fail under these conditions. A work-around is to set <code>n_threads = 0</code>, because the index will not be written to disk and re-loaded under these circumstances, at the cost of a longer search time. Alternatively, set the <code>pca</code> parameter to reduce the dimensionality or lower <code>n_trees</code>, both of which will reduce the size of the index on disk. However, either may lower the accuracy of the nearest neighbor results.</p>
</div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.1.2" id="uwot-012">uwot 0.1.2<a class="anchor" aria-label="anchor" href="#uwot-012"></a></h2><p class="text-muted">CRAN release: 2019-04-06</p>
<p>Initial CRAN release.</p>
<div class="section level3">
<h3 id="new-features-0-1-2">New features<a class="anchor" aria-label="anchor" href="#new-features-0-1-2"></a></h3>
<ul><li>New parameter, <code>tmpdir</code>, which allows the user to specify the temporary directory where nearest neighbor indexes will be written during Annoy nearest neighbor search. The default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">base::tempdir()</a></code>. Only used if <code>n_threads &gt; 1</code> and <code>nn_method = "annoy"</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-1-2">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-1-2"></a></h3>
<ul><li><p>Fixed an issue with <code>lvish</code> where there was an off-by-one error when calculating input probabilities.</p></li>
<li><p>Added a safe-guard to <code>lvish</code> to prevent the gaussian precision, beta, becoming overly large when the binary search fails during perplexity calibration.</p></li>
<li><p>The <code>lvish</code> perplexity calibration uses the log-sum-exp trick to avoid numeric underflow if beta becomes large.</p></li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9010" id="uwot-0009010-31-march-2019">uwot 0.0.0.9010 (31 March 2019)<a class="anchor" aria-label="anchor" href="#uwot-0009010-31-march-2019"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9010">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9010"></a></h3>
<ul><li>New parameter: <code>pcg_rand</code>. If <code>TRUE</code> (the default), then a random number generator from <a href="https://www.pcg-random.org/" class="external-link">the PCG family</a> is used during the stochastic optimization phase. The old PRNG, a direct translation of an implementation of the Tausworthe “taus88” PRNG used in the Python version of UMAP, can be obtained by setting <code>pcg_rand = FALSE</code>. The new PRNG is slower, but is likely superior in its statistical randomness. This change in behavior will be break backwards compatibility: you will now get slightly different results even with the same seed.</li>
<li>New parameter: <code>fast_sgd</code>. If <code>TRUE</code>, then the following combination of parameters are set: <code>n_sgd_threads = "auto"</code>, <code>pcg_rand = FALSE</code> and <code>approx_pow = TRUE</code>. These will result in a substantially faster optimization phase, at the cost of being slightly less accurate and results not being exactly repeatable. <code>fast_sgd = FALSE</code> by default but if you are only interested in visualization, then <code>fast_sgd</code> gives perfectly good results. For more generic dimensionality reduction and reproducibility, keep <code>fast_sgd = FALSE</code>.</li>
<li>New parameter: <code>init_sdev</code> which specifies how large the standard deviation of each column of the initial coordinates should be. This will scale any input coordinates (including user-provided matrix coordinates). <code>init = "spca"</code> can now be thought of as an alias of <code>init = "pca", init_sdev = 1e-4</code>. This may be too aggressive scaling for some datasets. The typical UMAP spectral initializations tend to result in standard deviations of around <code>2</code> to <code>5</code>, so this might be more appropriate in some cases. If spectral initialization detects multiple components in the affinity graph and falls back to scaled PCA, it uses <code>init_sdev = 1</code>.</li>
<li>As a result of adding <code>init_sdev</code>, the <code>init</code> options <code>sspectral</code>, <code>slaplacian</code> and <code>snormlaplacian</code> have been removed (they weren’t around for very long anyway). You can get the same behavior by e.g. <code>init = "spectral", init_sdev = 1e-4</code>. <code>init = "spca"</code> is sticking around because I use it a lot.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-0-0-9010">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-0-0-9010"></a></h3>
<ul><li>Spectral initialization (the default) was sometimes generating coordinates that had too large a range, due to an erroneous scale factor that failed to account for negative coordinate values. This could give rise to embeddings with very noticeable outliers distant from the main clusters.</li>
<li>Also during spectral initialization, the amount of noise being added had a standard deviation an order of magnitude too large compared to the Python implementation (this probably didn’t make any difference though).</li>
<li>If requesting a spectral initialization, but multiple disconnected components are present, fall back to <code>init = "spca"</code>.</li>
<li>Removed dependency on C++ <code>&lt;random&gt;</code> header. This breaks backwards compatibility even if you set <code>pcg_rand = FALSE</code>.</li>
<li>
<code>metric = "cosine"</code> results were incorrectly using the unmodified Annoy angular distance.</li>
<li>Numeric matrix columns can be specified as the target for the <code>categorical</code> metric (fixes <a href="https://github.com/jlmelville/uwot/issues/20" class="external-link uri">https://github.com/jlmelville/uwot/issues/20</a>).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9009" id="uwot-0009009-1-january-2019">uwot 0.0.0.9009 (1 January 2019)<a class="anchor" aria-label="anchor" href="#uwot-0009009-1-january-2019"></a></h2>
<ul><li>Data is now stored column-wise during optimization, which should result in an increase in performance for larger values of <code>n_components</code> (e.g. approximately 50% faster optimization time with MNIST and <code>n_components = 50</code>).</li>
<li>New parameter: <code>pca_center</code>, which controls whether to center the data before applying PCA. It would be typical to set this to <code>FALSE</code> if you are applying PCA to binary data (although note you can’t use this with setting with <code>metric = "hamming"</code>)</li>
<li>PCA will now be used when the <code>metric</code> is <code>"manhattan"</code> and <code>"cosine"</code>. It’s still <em>not</em> applied when using <code>"hamming"</code> (data still needs to be in binary format, not real-valued).</li>
<li>If using mixed datatypes, you may override the <code>pca</code> and <code>pca_center</code> parameter values for a given data block by using a list for the value of the metric, with the column ids/names as an unnamed item and the overriding values as named items, e.g. instead of <code>manhattan = 1:100</code>, use <code>manhattan = list(1:100, pca_center = FALSE)</code> to turn off PCA centering for just that block. This functionality exists mainly for the case where you have mixed binary and real-valued data and want to apply PCA to both data types. It’s normal to apply centering to real-valued data but not to binary data.</li>
</ul><div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-0-0-9009">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-0-0-9009"></a></h3>
<ul><li>Fixed bug that affected <code>umap_transform</code>, where negative sampling was over the size of the test data (should be the training data).</li>
<li>Some other performance improvements (around 10% faster for the optimization stage with MNIST).</li>
<li>When <code>verbose = TRUE</code>, log the Annoy recall accuracy, which may help tune values of <code>n_trees</code> and <code>search_k</code>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9008" id="uwot-0009008-december-23-2018">uwot 0.0.0.9008 (December 23 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009008-december-23-2018"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9008">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9008"></a></h3>
<ul><li>New parameter: <code>n_sgd_threads</code>, which controls the number of threads used in the stochastic gradient descent. By default this is now single-threaded and should result in reproducible results when using <code>set.seed</code>. To get back the old, less consistent, but faster settings, set <code>n_sgd_threads = "auto"</code>.</li>
<li>API change for consistency with Python UMAP:
<ul><li>
<code>alpha</code> is now <code>learning_rate</code>.</li>
<li>
<code>gamma</code> is now <code>repulsion_strength</code>.</li>
</ul></li>
<li>Default spectral initialization now looks for disconnected components and initializes them separately (also applies to <code>laplacian</code> and <code>normlaplacian</code>).</li>
<li>New <code>init</code> options: <code>sspectral</code>, <code>snormlaplacian</code> and <code>slaplacian</code>. These are like <code>spectral</code>, <code>normlaplacian</code>, <code>laplacian</code> respectively, but scaled so that each dimension has a standard deviation of 1e-4. This is like the difference between the <code>pca</code> and <code>spca</code> options.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-0-0-9008">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-0-0-9008"></a></h3>
<ul><li>Hamming distance support (was actually using Euclidean distance).</li>
<li>Smooth knn/perplexity calibration results had a small dependency on the number of threads used.</li>
<li>Anomalously long spectral initialization times should now be reduced.</li>
<li>Internal changes and fixes thanks to a code review by <a href="https://github.com/ltla" class="external-link">Aaron Lun</a>.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9007" id="uwot-0009007-december-9-2018">uwot 0.0.0.9007 (December 9 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009007-december-9-2018"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9007">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9007"></a></h3>
<ul><li>New parameter <code>pca</code>: set this to a positive integer to reduce matrix of data frames to that number of columns using PCA. Only works if <code>metric = "euclidean"</code>. If you have &gt; 100 columns, this can substantially improve the speed of the nearest neighbor search. t-SNE implementations often set this value to 50.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-0-0-9007">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-0-0-9007"></a></h3>
<ul><li>Laplacian Eigenmap initialization convergence failure is now correctly detected.</li>
<li>C++ code was over-writing data passed from R as a function argument.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9006" id="uwot-0009006-december-5-2018">uwot 0.0.0.9006 (December 5 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009006-december-5-2018"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9006">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9006"></a></h3>
<ul><li>Highly experimental mixed data type support for <code>metric</code>: instead of specifying a single metric name (e.g. <code>metric = "euclidean"</code>), you can pass a list, where the name of each item is the metric to use and the value is a vector of the names of the columns to use with that metric, e.g. <code>metric = list("euclidean" = c("A1", "A2"), "cosine" = c("B1", "B2", "B3"))</code> treats columns <code>A1</code> and <code>A2</code> as one block, using the Euclidean distance to find nearest neighbors, whereas <code>B1</code>, <code>B2</code> and <code>B3</code> are treated as a second block, using the cosine distance.</li>
<li>Factor columns can also be used in the metric, using the metric name <code>categorical</code>.</li>
<li>
<code>y</code> may now be a data frame or matrix if multiple target data is available.</li>
<li>New parameter <code>target_metric</code>, to specify the distance metric to use with numerical <code>y</code>. This has the same capabilities as <code>metric</code>.</li>
<li>Multiple external nearest neighbor data sources are now supported. Instead of passing a list of two matrices, pass a list of lists, one for each external metric.</li>
<li>More details on mixed data types can be found at <a href="https://github.com/jlmelville/uwot#mixed-data-types" class="external-link uri">https://github.com/jlmelville/uwot#mixed-data-types</a>.</li>
<li>Compatibility with older versions of RcppParallel (contributed by <a href="https://github.com/sirusb" class="external-link">sirusb</a>).</li>
<li>
<code>scale = "Z"</code> To Z-scale each column of input (synonym for <code>scale = TRUE</code> or <code>scale = "scale"</code>).</li>
<li>New scaling option, <code>scale = "colrange"</code> to scale columns in the range (0, 1).</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9005" id="uwot-0009005-november-4-2018">uwot 0.0.0.9005 (November 4 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009005-november-4-2018"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9005">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9005"></a></h3>
<ul><li>Hamming distance is now supported, due to upgrade to RcppAnnoy 0.0.11.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9004" id="uwot-0009004-october-21-2018">uwot 0.0.0.9004 (October 21 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009004-october-21-2018"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9004">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9004"></a></h3>
<ul><li>For supervised UMAP with numeric <code>y</code>, you may pass nearest neighbor data directly, in the same format as that supported by <code>X</code>-related nearest neighbor data. This may be useful if you don’t want to use Euclidean distances for the <code>y</code> data, or if you have missing data (and have a way to assign nearest neighbors for those cases, obviously). See the <a href="https://github.com/jlmelville/uwot#nearest-neighbor-data-format" class="external-link">Nearest Neighbor Data Format</a> section for details.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9003" id="uwot-0009003-september-22-2018">uwot 0.0.0.9003 (September 22 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009003-september-22-2018"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9003">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9003"></a></h3>
<ul><li>New parameter <code>ret_nn</code>: when <code>TRUE</code> returns nearest neighbor matrices as a <code>nn</code> list: indices in item <code>idx</code> and distances in item <code>dist</code>. Embedded coordinates are in <code>embedding</code>. Both <code>ret_nn</code> and <code>ret_model</code> can be <code>TRUE</code>, and should not cause any compatibility issues with supervised embeddings.</li>
<li>
<code>nn_method</code> can now take precomputed nearest neighbor data. Must be a list of two matrices: <code>idx</code>, containing integer indexes, and <code>dist</code> containing distances. By no coincidence, this is the format return by <code>ret_nn</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-0-0-9003">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-0-0-9003"></a></h3>
<ul><li>Embedding to <code>n_components = 1</code> was broken (<a href="https://github.com/jlmelville/uwot/issues/6" class="external-link uri">https://github.com/jlmelville/uwot/issues/6</a>)</li>
<li>User-supplied matrices to <code>init</code> parameter were being modified, in defiance of basic R pass-by-copy semantics.</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9002" id="uwot-0009002-august-14-2018">uwot 0.0.0.9002 (August 14 2018)<a class="anchor" aria-label="anchor" href="#uwot-0009002-august-14-2018"></a></h2>
<div class="section level3">
<h3 id="bug-fixes-and-minor-improvements-0-0-0-9002">Bug fixes and minor improvements<a class="anchor" aria-label="anchor" href="#bug-fixes-and-minor-improvements-0-0-0-9002"></a></h3>
<ul><li>
<code>metric = "cosine"</code> is working again for <code>n_threads</code> greater than <code>0</code> (<a href="https://github.com/jlmelville/uwot/issues/5" class="external-link uri">https://github.com/jlmelville/uwot/issues/5</a>)</li>
</ul></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.0.0.9001" id="uwot-0009001">uwot 0.0.0.9001<a class="anchor" aria-label="anchor" href="#uwot-0009001"></a></h2>
<div class="section level3">
<h3 id="new-features-0-0-0-9001">New features<a class="anchor" aria-label="anchor" href="#new-features-0-0-0-9001"></a></h3>
<ul><li><p><em>August 5 2018</em>. You can now use an existing embedding to add new points via <code>umap_transform</code>. See the example section below.</p></li>
<li><p><em>August 1 2018</em>. Numerical vectors are now supported for supervised dimension reduction.</p></li>
<li><p><em>July 31 2018</em>. (Very) initial support for supervised dimension reduction: categorical data only at the moment. Pass in a factor vector (use <code>NA</code> for unknown labels) as the <code>y</code> parameter and edges with bad (or unknown) labels are down-weighted, hopefully leading to better separation of classes. This works remarkably well for the Fashion MNIST dataset.</p></li>
<li><p><em>July 22 2018</em>. You can now use the cosine and Manhattan distances with the Annoy nearest neighbor search, via <code>metric = "cosine"</code> and <code>metric = "manhattan"</code>, respectively. Hamming distance is not supported because RcppAnnoy doesn’t yet support it.</p></li>
</ul></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James Melville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

