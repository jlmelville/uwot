<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reproducibility • uwot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Reproducibility">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">uwot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/uwot.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jlmelville/uwot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reproducibility</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jlmelville/uwot/blob/master/vignettes/articles/reproducibility.Rmd" class="external-link"><code>vignettes/articles/reproducibility.Rmd</code></a></small>
      <div class="d-none name"><code>reproducibility.Rmd</code></div>
    </div>

    
    
<p><code>uwot</code> relies on the underlying compiler and C++ standard
library on your machine and this can result in differences in output
even with the same input data, arguments, packages and R version. If you
require reproducibility between machines, it is strongly suggested that
you stick with the same OS and compiler version on all of them (e.g. a
fixed LTS of a Linux distro and gcc version). Otherwise, the following
can help:</p>
<ul>
<li>Use the <code>tumap</code> method instead of <code>umap</code>. This
avoid the use of <code>std::pow</code> in gradient calculations. This
also has the advantage of being faster to optimize. However, this gives
larger clusters in the output, and you don’t have the ability to control
that with <code>a</code> and <code>b</code> (or <code>spread</code> and
<code>min_dist</code>) parameters.</li>
<li>For <code>umap</code>, it’s better to provide <code>a</code> and
<code>b</code> directly with a fixed precision rather than allowing them
to be calculated via the <code>spread</code> and <code>min_dist</code>
parameters. For default UMAP, use
<code>a = 1.8956, b = 0.8006</code>.</li>
<li>Use <code>approx_pow = TRUE</code>, which avoids the use of the
<code>std::pow</code> function.</li>
<li>Use <code>init = "spca"</code> rather than
<code>init = "spectral"</code> (although the latter is the default and
preferred method for UMAP initialization).</li>
<li>If <code>n_sgd_threads</code> is set larger than <code>1</code>,
then even if you use <code>set.seed</code>, results of the embeddings
are not repeatable, This is because there is no locking carried out on
the underlying coordinate matrix, and work is partitioned by edge not
vertex and a given vertex may be processed by different threads. The
order in which reads and writes occur is of course at the whim of the
thread scheduler. This is the same behavior as LargeVis.</li>
<li>Use <code>rng_type = "deterministic</code>, which will make vertex
sampling during the optimization deterministic. Note that this will
<em>not</em> affect the use of a random number generator in other parts
of the algorithm, such as approximate nearest neighbor search and
initialization. This may give slightly less accurate results due to the
lack of random sampling but the trade-off may be worth it (and it’s also
a bit faster).</li>
<li>For random number generation, you can provide a <code>seed</code>
parameter. This doesn’t do anything other than call
<code>set.seed</code> for you inside the routine, but you may find it
convenient to fix the seed in the call to <code>umap</code>.</li>
</ul>
<p>In summary, your chances of reproducibility are increased by
using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mnist_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">mnist</span>, a <span class="op">=</span> <span class="fl">1.8956</span>, b <span class="op">=</span> <span class="fl">0.8006</span>, approx_pow <span class="op">=</span> <span class="cn">TRUE</span>, init <span class="op">=</span> <span class="st">"spca"</span>, batch <span class="op">=</span> <span class="cn">TRUE</span>, rng_type <span class="op">=</span> <span class="st">"deterministic"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">mnist_tumap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tumap.html">tumap</a></span><span class="op">(</span><span class="va">mnist</span>, init <span class="op">=</span> <span class="st">"spca"</span>, batch <span class="op">=</span> <span class="cn">TRUE</span>, rng_type <span class="op">=</span> <span class="st">"deterministic"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Melville.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
