<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="uwot">
<title>Initialization • uwot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Initialization">
<meta property="og:description" content="uwot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">uwot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/uwot.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jlmelville/uwot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Initialization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jlmelville/uwot/blob/HEAD/vignettes/articles/init.Rmd" class="external-link"><code>vignettes/articles/init.Rmd</code></a></small>
      <div class="d-none name"><code>init.Rmd</code></div>
    </div>

    
    
<p>The default initialization for UMAP uses the eigenvectors of a
normalized graph Laplacian of the sparse affinity matrix. This normally
works well except when:</p>
<ul>
<li>The graph has disconnected components, in which case you really have
multiple separate graphs. In <code>uwot</code>, there is a risk that the
<a href="https://cran.r-project.org/package=RSpectra" class="external-link">RSpectra</a> can
have trouble converging under these circumstances.</li>
<li>Even with a connected graph, there can sometimes be convergence
issues, which I have tried to mitigate. However, there is a still a risk
of a very long initialization, and possibly a hang. Unfortunately,
interrupting RSpectra can result in requiring the entire R session to be
lost.</li>
</ul>
<p>An alternative to using the spectral initialization is to use PCA,
although depending on the scaling of your input variables, this could
lead to a quite spread-out initial set of coordinates, which can be hard
to optimize. For the related technique t-SNE, <a href="https://www.biorxiv.org/content/10.1101/453449v1" class="external-link">Kobak and
Berens</a> recommend scaling the PCA results so that the standard
deviation for each dimension is <code>1e-4</code>. You can get that
behavior in <code>uwot</code> by using <code>init = "spca"</code>.</p>
<p>You don’t need to worry about disconnected components when attempting
to use spectral initialization: if <code>uwot</code> detects more than
one component in the affinity graph, it will fall back to using the
<code>"spca"</code> initialization automatically.</p>
<p>However, using PCA ignores the information in the affinity matrix
that might be useful for initialization: for example, when using
supervised UMAP or mixing different types of distance metrics. And
conceptually, using the affinity matrix has a lot of appeal. Dzwinel and
co-workers describe a very fast multi-dimensional scaling-like method
called <a href="https://arxiv.org/abs/1902.01108" class="external-link">ivhd</a> which
generates a connected graph, by only knowing only a few neighbor and
non-neighbor points and pretending the target distances are 0 and 1,
respectively. Similar theoretical support for this is given by <a href="https://arxiv.org/abs/1711.04712" class="external-link">Linderman and co-workers</a>. On
the basis of this work, I have implemented an “approximate global”
spectral method of initialization: which is a very minor modification of
the standard spectral initialization:</p>
<ul>
<li>All non-zero elements of the affinity matrix are set to 1.</li>
<li>A random number of the zero elements are set to 0.1, at a rate of
<code>n_neg_samples</code> for each positive edge in the graph. This is
consistent with the ratio of neighbor to non-neighbor edge sampling
during optimization and, if using a default value of
<code>n_neg_samples</code>, is a similar order of magnitude as the ratio
of neighbor to non-neighbor entries in the graph that is used with
ivhd.</li>
<li>Theoretically, this should be enough to guarantee a graph with a
single component. The spectral initialization is carried out.</li>
<li>After initialization, the original affinity matrix is used for
optimization.</li>
</ul>
<p>You can get this behavior in uwot with
<code>init = "agspectral"</code>.</p>
<p>Another option for a connected graph is to use a variation on the
normalization used in the graph Laplacian to get something close to <a href="https://doi.org/10.1162/089976603321780317" class="external-link">Laplacian Eigenmap</a>
with <code>init = "laplacian"</code>. In <a href="http://www.kyb.mpg.de/fileadmin/user_upload/files/publications/attachments/luxburg06_TR_v2_4139%5b1%5d.pdf" class="external-link">Luxburg’s
spectral clustering tutorial (PDF)</a> this form of normalization is
recommended over that used in the <code>init = "spectral"</code>
normalization.</p>
<p>If all else fails, you can use random initialization. In the spirit
of generosity, <code>uwot</code> offers two types of random
initialization. The first is that used by UMAP, which uses a random
uniform distribution between -10 and +10 along each axis. You can get
this with <code>init = "rand"</code>. Alternatively, there is the method
favoured by LargeVis (and used by default with <code>lvish</code>),
which is to use a Gaussian distribution with standard deviation 1e-4.
This is also the method used by t-SNE. You can get this by setting
<code>init = "lvrand"</code>.</p>
<p>To summarize your options:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default initialization: use spectral initialization if possible</span></span>
<span><span class="co"># falling back to scaled PCA if multiple components are found in the graph</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># same as the above</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span>, init <span class="op">=</span> <span class="st">"spectral"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use scaled PCA</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span>, init <span class="op">=</span> <span class="st">"spca"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use an "approximate global" spectral initialization that should be applicable</span></span>
<span><span class="co"># even under conditions where "spectral" fails and has to use spca</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span>, init <span class="op">=</span> <span class="st">"agspectral"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use a Laplacian Eigenmap style initialization, which will also fall back to</span></span>
<span><span class="co"># spca if it has to</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span>, init <span class="op">=</span> <span class="st">"laplacian"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use random initialization, UMAP style</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span>, init <span class="op">=</span> <span class="st">"rand"</span><span class="op">)</span></span>
<span><span class="co"># use random initialization, t-SNE/LargeVis style</span></span>
<span><span class="va">embedding</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">data</span>, init <span class="op">=</span> <span class="st">"lvrand"</span><span class="op">)</span></span></code></pre></div>
<p>Below, we’ll explore the effect of these settings. For more details
on the datasets, see the <a href="https://jlmelville.github.io/uwot/articles/umap-examples.html">examples</a>
page.</p>
<p>Apart from changing <code>init</code>, mainly default settings where
used, except using <code>pca = 100</code>, which is necessary with high
dimensional datasets for the Annoy-based nearest neighbor search to
complete in a reasonable time. An exemplary command using the
<code>iris</code> dataset and <code>"agspectral"</code>
initialization:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1337</span><span class="op">)</span></span>
<span><span class="va">iris_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">iris</span>, pca <span class="op">=</span> <span class="fl">100</span>, init <span class="op">=</span> <span class="st">"agspectral"</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="spectral-vs-spca">Spectral vs SPCA<a class="anchor" aria-label="anchor" href="#spectral-vs-spca"></a>
</h2>
<p>Below are some examples of using either the scaled PCA initialization
or a spectral approach. On the first row, the left-hand image is the
result of using <code>init = "spca"</code>, and the right-hand image is
<code>init = "agspectral"</code>. On the second row, the left-hand image
is for <code>init = "spectral"</code>. and the right-hand image is
<code>init = "laplacian"</code>. Some datasets don’t have the second row
of images, because with the settings used here, they generate more than
one component in the graph, and therefore both
<code>init = "spectral"</code> and <code>init = "laplacian"</code> would
fall back to the same results as seen with
<code>init = "spca"</code>.</p>
<div class="section level3">
<h3 id="iris">iris<a class="anchor" aria-label="anchor" href="#iris"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/iris_spca.png" alt="iris spca"></td>
<td align="center"><img src="img/init/iris_agspectral.png" alt="iris agspectral"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="s1k">s1k<a class="anchor" aria-label="anchor" href="#s1k"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/s1k_spca.png" alt="s1k spca"></td>
<td align="center"><img src="img/init/s1k_agspectral.png" alt="s1k agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/s1k_spectral.png" alt="s1k spectral"></td>
<td align="center"><img src="img/init/s1k_laplacian.png" alt="s1k laplacian"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="oli">oli<a class="anchor" aria-label="anchor" href="#oli"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/oli_spca.png" alt="oli spca"></td>
<td align="center"><img src="img/init/oli_agspectral.png" alt="oli agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/oli_spectral.png" alt="oli spectral"></td>
<td align="center"><img src="img/init/oli_laplacian.png" alt="oli laplacian"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="frey">frey<a class="anchor" aria-label="anchor" href="#frey"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/frey_spca.png" alt="frey spca"></td>
<td align="center"><img src="img/init/frey_agspectral.png" alt="frey agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/frey_spectral.png" alt="frey spectral"></td>
<td align="center"><img src="img/init/frey_laplacian.png" alt="frey laplacian"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil20">coil20<a class="anchor" aria-label="anchor" href="#coil20"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil20_spca.png" alt="coil20 spca"></td>
<td align="center"><img src="img/init/coil20_agspectral.png" alt="coil20 agspectral"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil100">coil100<a class="anchor" aria-label="anchor" href="#coil100"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil100_spca.png" alt="coil100 spca"></td>
<td align="center"><img src="img/init/coil100_agspectral.png" alt="coil100 agspectral"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="mnist">mnist<a class="anchor" aria-label="anchor" href="#mnist"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/mnist_spca.png" alt="mnist spca"></td>
<td align="center"><img src="img/init/mnist_agspectral.png" alt="mnist agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/mnist_spectral.png" alt="mnist spectral"></td>
<td align="center"><img src="img/init/mnist_laplacian.png" alt="mnist laplacian"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="fashion">fashion<a class="anchor" aria-label="anchor" href="#fashion"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/fashion_spca.png" alt="fashion spca"></td>
<td align="center"><img src="img/init/fashion_agspectral.png" alt="fashion agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/fashion_spectral.png" alt="fashion spectral"></td>
<td align="center"><img src="img/init/fashion_laplacian.png" alt="fashion laplacian"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="kuzushiji">kuzushiji<a class="anchor" aria-label="anchor" href="#kuzushiji"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/kuzushiji_spca.png" alt="kuzushiji spca"></td>
<td align="center"><img src="img/init/kuzushiji_agspectral.png" alt="kuzushiji agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/kuzushiji_spectral.png" alt="kuzushiji spectral"></td>
<td align="center"><img src="img/init/kuzushiji_laplacian.png" alt="kuzushiji laplacian"></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="norb">norb<a class="anchor" aria-label="anchor" href="#norb"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/norb_spca.png" alt="norb spca"></td>
<td align="center"><img src="img/init/norb_agspectral.png" alt="norb agspectral"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="tasic2018">tasic2018<a class="anchor" aria-label="anchor" href="#tasic2018"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/tasic2018_spca.png" alt="tasic2018 spca"></td>
<td align="center"><img src="img/init/tasic2018_agspectral.png" alt="tasic2018 agspectral"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="macosko2015">macosko2015<a class="anchor" aria-label="anchor" href="#macosko2015"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="img/init/macosko2015_spca.png" alt="macosko2015 spca"></td>
<td align="center"><img src="img/init/macosko2015_agspectral.png" alt="macosko2015 agspectral"></td>
</tr>
<tr class="even">
<td align="center"><img src="img/init/macosko2015_spectral.png" alt="macosko2015 spectral"></td>
<td align="center"><img src="img/init/macosko2015_laplacian.png" alt="macosko2015 laplacian"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="spca-init_sdev">SPCA init_sdev<a class="anchor" aria-label="anchor" href="#spca-init_sdev"></a>
</h2>
<p>As mentioned earlier, the <code>init = "spca"</code> settings scales
the PCA initialization to have a standard deviation of
<code>1e-4</code>, as recommended by Kobak and Berens. This value is
taken from the t-SNE initialization, so if it seems arbitrary, at least
it has a history of being quite successful on its side. But for MNIST,
one of the clusters has been broken up, and this wasn’t seen with the
spectral initialization. I repeated the embedding with a different seed
(results not shown) and again saw a split cluster, so probably this
wasn’t due to bad luck with the random number generator.</p>
<p>Could the standard deviation of the input be to blame? Although this
setting works well with t-SNE, the normalization involved in that method
may mean that the sort of gradients seen at those distances are quite
different from those used with UMAP. To test this, below are results
using a larger standard deviation. Results on the left use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">iris</span>, init <span class="op">=</span> <span class="st">"spca"</span>, init_sdev <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p>and those on the right:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">iris</span>, init <span class="op">=</span> <span class="st">"spca"</span>, init_sdev <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="iris-1">iris<a class="anchor" aria-label="anchor" href="#iris-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/iris_spca1e-2.png" alt="iris spca1e-2"></td>
<td align="center"><img src="img/init/iris_spca1.png" alt="iris spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="s1k-1">s1k<a class="anchor" aria-label="anchor" href="#s1k-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/s1k_spca1e-2.png" alt="s1k spca1e-2"></td>
<td align="center"><img src="img/init/s1k_spca1.png" alt="s1k spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="oli-1">oli<a class="anchor" aria-label="anchor" href="#oli-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/oli_spca1e-2.png" alt="oli spca1e-2"></td>
<td align="center"><img src="img/init/oli_spca1.png" alt="oli spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="frey-1">frey<a class="anchor" aria-label="anchor" href="#frey-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/frey_spca1e-2.png" alt="frey spca1e-2"></td>
<td align="center"><img src="img/init/frey_spca1.png" alt="frey spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil20-1">coil20<a class="anchor" aria-label="anchor" href="#coil20-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil20_spca1e-2.png" alt="coil20 spca1e-2"></td>
<td align="center"><img src="img/init/coil20_spca1.png" alt="coil20 spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil100-1">coil100<a class="anchor" aria-label="anchor" href="#coil100-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil100_spca1e-2.png" alt="coil100 spca1e-2"></td>
<td align="center"><img src="img/init/coil100_spca1.png" alt="coil100 spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="mnist-1">mnist<a class="anchor" aria-label="anchor" href="#mnist-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/mnist_spca1e-2.png" alt="mnist spca1e-2"></td>
<td align="center"><img src="img/init/mnist_spca1.png" alt="mnist spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="fashion-1">fashion<a class="anchor" aria-label="anchor" href="#fashion-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/fashion_spca1e-2.png" alt="fashion spca1e-2"></td>
<td align="center"><img src="img/init/fashion_spca1.png" alt="fashion spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="kuzushiji-1">kuzushiji<a class="anchor" aria-label="anchor" href="#kuzushiji-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/kuzushiji_spca1e-2.png" alt="kuzushiji spca1e-2"></td>
<td align="center"><img src="img/init/kuzushiji_spca1.png" alt="kuzushiji spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="norb-1">norb<a class="anchor" aria-label="anchor" href="#norb-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/norb_spca1e-2.png" alt="norb spca1e-2"></td>
<td align="center"><img src="img/init/norb_spca1.png" alt="norb spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="tasic2018-1">tasic2018<a class="anchor" aria-label="anchor" href="#tasic2018-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/tasic2018_spca1e-2.png" alt="tasic2018 spca1e-2"></td>
<td align="center"><img src="img/init/tasic2018_spca1.png" alt="tasic2018 spca1"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="macosko2015-1">macosko2015<a class="anchor" aria-label="anchor" href="#macosko2015-1"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/macosko2015_spca1e-2.png" alt="macosko2015 spca1e-2"></td>
<td align="center"><img src="img/init/macosko2015_spca1.png" alt="macosko2015 spca1"></td>
</tr></tbody>
</table>
<p>Results are much better with a larger value for
<code>init_sdev</code>. As the typical standard deviation of a spectral
initialization for these datasets is in the range of 1-5, using
<code>init_sdev = 1</code>, seems like a good place to start.</p>
</div>
</div>
<div class="section level2">
<h2 id="random-initialization-rand">Random Initialization: <code>rand</code><a class="anchor" aria-label="anchor" href="#random-initialization-rand"></a>
</h2>
<p>Below are two results each from using random initialization, so you
can get a sense for how much variation you can expect from getting lucky
or not with the initialization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># left-hand plots used this seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1337</span><span class="op">)</span></span>
<span><span class="co"># right-hand plots used this seed</span></span>
<span><span class="co"># set.seed(42)</span></span>
<span><span class="va">iris_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">iris</span>, init <span class="op">=</span> <span class="st">"rand"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="iris-2">iris<a class="anchor" aria-label="anchor" href="#iris-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/iris_rand1.png" alt="iris rand1"></td>
<td align="center"><img src="img/init/iris_rand2.png" alt="iris rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="s1k-2">s1k<a class="anchor" aria-label="anchor" href="#s1k-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/s1k_rand1.png" alt="s1k rand1"></td>
<td align="center"><img src="img/init/s1k_rand2.png" alt="s1k rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="oli-2">oli<a class="anchor" aria-label="anchor" href="#oli-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/oli_rand1.png" alt="oli rand1"></td>
<td align="center"><img src="img/init/oli_rand2.png" alt="oli rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="frey-2">frey<a class="anchor" aria-label="anchor" href="#frey-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/frey_rand1.png" alt="frey rand1"></td>
<td align="center"><img src="img/init/frey_rand2.png" alt="frey rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil20-2">coil20<a class="anchor" aria-label="anchor" href="#coil20-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil20_rand1.png" alt="coil20 rand1"></td>
<td align="center"><img src="img/init/coil20_rand2.png" alt="coil20 rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil100-2">coil100<a class="anchor" aria-label="anchor" href="#coil100-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil100_rand1.png" alt="coil100 rand1"></td>
<td align="center"><img src="img/init/coil100_rand2.png" alt="coil100 rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="mnist-2">mnist<a class="anchor" aria-label="anchor" href="#mnist-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/mnist_rand1.png" alt="mnist rand1"></td>
<td align="center"><img src="img/init/mnist_rand2.png" alt="mnist rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="fashion-2">fashion<a class="anchor" aria-label="anchor" href="#fashion-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/fashion_rand1.png" alt="fashion rand1"></td>
<td align="center"><img src="img/init/fashion_rand2.png" alt="fashion rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="kuzushiji-2">kuzushiji<a class="anchor" aria-label="anchor" href="#kuzushiji-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/kuzushiji_rand1.png" alt="kuzushiji rand1"></td>
<td align="center"><img src="img/init/kuzushiji_rand2.png" alt="kuzushiji rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="norb-2">norb<a class="anchor" aria-label="anchor" href="#norb-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/norb_rand1.png" alt="norb rand1"></td>
<td align="center"><img src="img/init/norb_rand2.png" alt="norb rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="tasic2018-2">tasic2018<a class="anchor" aria-label="anchor" href="#tasic2018-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/tasic2018_rand1.png" alt="tasic2018 rand1"></td>
<td align="center"><img src="img/init/tasic2018_rand2.png" alt="tasic2018 rand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="macosko2015-2">macosko2015<a class="anchor" aria-label="anchor" href="#macosko2015-2"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/macosko2015_rand1.png" alt="macosko2015 rand1"></td>
<td align="center"><img src="img/init/macosko2015_rand2.png" alt="macosko2015 rand2"></td>
</tr></tbody>
</table>
<p>Broken-up clusters are again observed, although the prevalence is
increased. I tried repeating these embeddings with
<code>init_sdev = 1</code>, but that didn’t help.</p>
</div>
</div>
<div class="section level2">
<h2 id="random-initialization-lvrand">Random Initialization: <code>lvrand</code><a class="anchor" aria-label="anchor" href="#random-initialization-lvrand"></a>
</h2>
<p>And here is the result of using random initialization in the
t-SNE/LargeVis style, which use a Gaussian distribution over a much
smaller initial range of coordinate values. Will it make much
difference?</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># left-hand plots used this seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1337</span><span class="op">)</span></span>
<span><span class="co"># right-hand plots used this seed</span></span>
<span><span class="co"># set.seed(42)</span></span>
<span><span class="va">iris_umap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/umap.html">umap</a></span><span class="op">(</span><span class="va">iris</span>, init <span class="op">=</span> <span class="st">"lvrand"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="iris-3">iris<a class="anchor" aria-label="anchor" href="#iris-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/iris_lvrand1.png" alt="iris lvrand1"></td>
<td align="center"><img src="img/init/iris_lvrand2.png" alt="iris lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="s1k-3">s1k<a class="anchor" aria-label="anchor" href="#s1k-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/s1k_lvrand1.png" alt="s1k lvrand1"></td>
<td align="center"><img src="img/init/s1k_lvrand2.png" alt="s1k lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="oli-3">oli<a class="anchor" aria-label="anchor" href="#oli-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/oli_lvrand1.png" alt="oli lvrand1"></td>
<td align="center"><img src="img/init/oli_lvrand2.png" alt="oli lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="frey-3">frey<a class="anchor" aria-label="anchor" href="#frey-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/frey_lvrand1.png" alt="frey lvrand1"></td>
<td align="center"><img src="img/init/frey_lvrand2.png" alt="frey lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil20-3">coil20<a class="anchor" aria-label="anchor" href="#coil20-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil20_lvrand1.png" alt="coil20 lvrand1"></td>
<td align="center"><img src="img/init/coil20_lvrand2.png" alt="coil20 lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="coil100-3">coil100<a class="anchor" aria-label="anchor" href="#coil100-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/coil100_lvrand1.png" alt="coil100 lvrand1"></td>
<td align="center"><img src="img/init/coil100_lvrand2.png" alt="coil100 lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="mnist-3">mnist<a class="anchor" aria-label="anchor" href="#mnist-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/mnist_lvrand1.png" alt="mnist lvrand1"></td>
<td align="center"><img src="img/init/mnist_lvrand2.png" alt="mnist lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="fashion-3">fashion<a class="anchor" aria-label="anchor" href="#fashion-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/fashion_lvrand1.png" alt="fashion lvrand1"></td>
<td align="center"><img src="img/init/fashion_lvrand2.png" alt="fashion lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="kuzushiji-3">kuzushiji<a class="anchor" aria-label="anchor" href="#kuzushiji-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/kuzushiji_lvrand1.png" alt="kuzushiji lvrand1"></td>
<td align="center"><img src="img/init/kuzushiji_lvrand2.png" alt="kuzushiji lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="norb-3">norb<a class="anchor" aria-label="anchor" href="#norb-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/norb_lvrand1.png" alt="norb lvrand1"></td>
<td align="center"><img src="img/init/norb_lvrand2.png" alt="norb lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="tasic2018-3">tasic2018<a class="anchor" aria-label="anchor" href="#tasic2018-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/tasic2018_lvrand1.png" alt="tasic2018 lvrand1"></td>
<td align="center"><img src="img/init/tasic2018_lvrand2.png" alt="tasic2018 lvrand2"></td>
</tr></tbody>
</table>
</div>
<div class="section level3">
<h3 id="macosko2015-3">macosko2015<a class="anchor" aria-label="anchor" href="#macosko2015-3"></a>
</h3>
<table class="table">
<colgroup>
<col width="51%">
<col width="48%">
</colgroup>
<tbody><tr class="odd">
<td align="center"><img src="img/init/macosko2015_lvrand1.png" alt="macosko2015 lvrand1"></td>
<td align="center"><img src="img/init/macosko2015_lvrand2.png" alt="macosko2015 lvrand2"></td>
</tr></tbody>
</table>
<p>No, it doesn’t make a huge difference. MNIST still has an issue with
split clusters. And increasing the <code>init_sdev</code> value doesn’t
really help. What did help was increasing the <code>n_neighbors</code>
parameter. With <code>n_neighbors = 150</code>, the MNIST clusters were
correctly reconstituted.</p>
</div>
</div>
<div class="section level2">
<h2 id="recommendations">Recommendations<a class="anchor" aria-label="anchor" href="#recommendations"></a>
</h2>
<p>The default spectral initialization does a good job, and the fallback
to scaled PCA is also fine, as long as you set the
<code>init_sdev = 1</code>. From <code>uwot</code> version 0.0.0.9010,
these are the default initialization settings.</p>
<p>As far as I can see, the <code>init = "agspectral"</code> settings
also work well. There’s not much difference between them and the
<code>init = "spectral"</code> results when spectral initialization
succeeds, and it has the added advantage that it shouldn’t ever have to
fall back to the scaled PCA approach. That means it might give a more
relevant initialization than PCA (e.g. with supervised UMAP). The
Laplacian Eigenmap initialization gives results that are very similar to
the spectral initialization. If spectral initialization is causing
problems (e.g. suffering from numeric issues that cause it to take too
long), I would probably look at the <code>agspectral</code> settings
before Laplacian Eigenmaps, as it is more likely to converge easily and
it doesn’t need a single-component graph to work. That said, the
<code>agspectral</code> approach is entirely my own invention, whereas a
Laplacian Eigenmaps is a published technique, so you may have more
confidence in the latter (I don’t blame you).</p>
<p>The random initializations are probably the least good choice. With
default settings, you run a sizable risk of splitting up clusters. This
can be ameliorated by increasing the <code>n_neighbors</code> parameter,
but this increases the run time and other methods don’t seem as
sensitive to these issues.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Melville.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
