<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PaCMAP Comparison • uwot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="PaCMAP Comparison">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">uwot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/uwot.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jlmelville/uwot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PaCMAP Comparison</h1>
            <h3 data-toc-skip class="subtitle">Making UMAP behave (more)
like PaCMAP</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jlmelville/uwot/blob/master/vignettes/articles/pacmap-comparison.Rmd" class="external-link"><code>vignettes/articles/pacmap-comparison.Rmd</code></a></small>
      <div class="d-none name"><code>pacmap-comparison.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PaCMAP (<a href="https://jmlr.org/papers/v22/20-1061.html" class="external-link">paper</a>,
<a href="https://github.com/YingfanWang/PaCMAP" class="external-link">repo</a>) is a
highly-regarded dimensionality method, firmly in the LargeVis/UMAP
family. It’s main point of differentiation from related methods is that
it balances local and global structure without needing to tune
hyperparameters. The PaCMAP authors’ <a href="https://sites.duke.edu/dimensionreduction/" class="external-link">blog post</a>
explicitly states:</p>
<blockquote>
<p>PaCMAP has no parameters that are designed to be tuned.</p>
</blockquote>
<p>Bold words! Also PaCMAP is pretty fast.</p>
<p>Alas there is no native R package for PaCMAP (as far as I know). You
can of course call it via <code>reticulate</code>, and the PaCMAP repo
has a <a href="https://github.com/YingfanWang/PaCMAP/blob/master/demo/pacmap_Rnotebook_example.Rmd" class="external-link">notebook</a>
demonstrating that. But that’s a bit unsatisfactory. I have spent a lot
of time studying the Python code and you can see my <a href="https://jlmelville.github.io/smallvis/pacmap.html" class="external-link">notes on the
method</a> if you want the details. The upshot of all that is that I
feel qualified to say that it would actually be quite hard to integrate
PaCMAP into <code>uwot</code>.</p>
</div>
<div class="section level2">
<h2 id="turning-umap-into-pacmap">Turning UMAP into PaCMAP?<a class="anchor" aria-label="anchor" href="#turning-umap-into-pacmap"></a>
</h2>
<p>But can we bend UMAP to make it behave more like PaCMAP? Here is a
very high-level overview of the most important ways that PaCMAP differs
from UMAP:</p>
<ul>
<li>Nearest neighbors are chosen using a method originating in <a href="https://papers.nips.cc/paper/2004/hash/40173ea48d9567f1f393b20c855bb40b-Abstract.html" class="external-link">self-tuning
spectral clustering</a> and also used in <a href="https://github.com/eamid/trimap" class="external-link">Trimap</a>. This rescales some
nearest neighbor distances based on local densities. This doesn’t seem
to make a massive difference in results in my testing so I won’t worry
about implementing it.</li>
<li>There is a special class of “mid-near” items, which are points
further away than nearest neighbors but closer than randomly-sampled
pairs. In the language of contrastive learning, you can think of these
as “semi-positive” examples. Use of these mid-near pairs requires
introducing a new loss term and gradient type, which is the main problem
with integrating PaCMAP into <code>uwot</code>. Plus there are different
weights applied to each component of the loss which changes during the
optimization process. This would require even more reworking of
<code>uwot</code>. Fortunately, it seems like most of the benefit of
this (and using mid-near items in general) is when you initialize the
embedding randomly. Let’s just not do that.</li>
<li>The negative examples for each item are are sampled once and then
re-used for all epochs, unlike UMAP which is always selecting different
vertices. We’re also not going to do this as this is probably just a
speed optimization rather than necessary for the working of the method
as a whole.</li>
<li>By default, if your input data has more than 100 columns, then
Truncated SVD is applied to reduce the dimensionality to 100. I’m not
really a fan of this as a default setting, but we can easily implement
it by setting <code>pca = 100</code>. It does seem to be an important
part of PaCMAP’s speed improvements too.</li>
<li>Initialization is with PCA, which is also easily implemented in
<code>uwot</code> with <code>init = "pca"</code>. PaCMAP then shrinks
this by multiplying all the coordinates by <code>0.01</code>. This is
supported by setting <code>init = "pacpca"</code> if you really want to
do it, but I don’t think it’s necessary (or actually that good an
idea).</li>
<li>The loss function and gradient for PaCMAP are rather different from
UMAP. In general these are more gentle than UMAP’s and cause less
tearing and twisting of any manifold structure in the embedded
coordinates. But in most real-world datasets I have looked at, there
isn’t a huge effect from the gradient.</li>
</ul>
<p>So from all of the above you can see that there are some reasonable
changes between UMAP and PaCMAP and most of my responses have been
“yeah, I don’t fancy changing that”. So to put my cards on the table, I
think the major source of differences between UMAP and PaCMAP are:</p>
<ul>
<li>Using PCA as initialization (this is the most important
difference).</li>
<li>Using PCA to reduce high-dimensional data to 100 dimensions.</li>
</ul>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>To make this simple I used:</p>
<ul>
<li>PaCMAP with its default settings. I used Python 3.12 and PaCMAP
0.7.3. There have been some patch releases since then, but it has no
meaningful effect on the results shown here.</li>
<li>For UMAP, I used default <code>umap2</code> parameters. HNSW was
used as the nearest neighbor method.</li>
</ul>
<p>I didn’t make any effort to match number of neighbors or number of
epochs and so on. I think these are all pretty comparable with their
default settings.</p>
<p>PCA was performed using <code>irlba</code>. To make results easier to
compare, the output coordinates were rigid-body rotated to align with
the PCA results using the Kabsch algorithm (the coordinates were also
additionally flipped along one dimension, and the result with lowest
error was chosen).</p>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>I tried to use a variety of datasets, including many used by the
PaCMAP authors in their paper and blog-post. Many of these had Python
code in the PaCMAP repo which was very useful. See the <a href="https://jlmelville.github.io/uwot/articles/umap-examples.html">examples
article</a> for more details on the datasets.</p>
<p>One extra dataset that we will also look at is <code>curve2d</code>,
a simple 2D curve. This is used as an example in the paper of how even
if you start with the original coordinates scaled by a constant,
dimensionality reduction methods will, rather than do nothing, still
distort the overall shape. Python code to generate the curve is at <a href="https://github.com/YingfanWang/PaCMAP/blob/master/experiments/run_experiments.py" class="external-link uri">https://github.com/YingfanWang/PaCMAP/blob/master/experiments/run_experiments.py</a>.</p>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>There’s a table of embeddings below. ased on my feelings that PCA is
the key to a lot of PaCMAP’s differences to UMAP, I have three different
settings of UMAP. From left to right the settings used were:</p>
<ul>
<li>UMAP with its default parameters (<code>UMAP</code>).</li>
<li>UMAP initialized with PCA (<code>UMAP PCA</code>),
i.e. <code>init = "pca"</code>.</li>
<li>UMAP with the input data reduced to 100 dimensions via PCA, if it
had more than 100 columns (<code>UMAP-PCA100</code>) <em>and</em> also
initialized with PCA, i.e.  <code>init = "pca", pca = 100</code>.</li>
</ul>
<p>Finally on the right are the embeddings from running PaCMAP.</p>
<p>I made no special effort to account for variability between runs for
either UMAP or PaCMAP. Based on having run these many, many times, I am
confident that the results are representative of the methods’
performance.</p>
<p>If you have javascript enabled, you can click on any image to
embiggen it.</p>
<table class="table">
<colgroup>
<col width="29%">
<col width="17%">
<col width="17%">
<col width="17%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="center">Dataset</th>
<th>UMAP</th>
<th>UMAP PCA</th>
<th>UMAP PCA100</th>
<th>PaCMAP</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">curve2d</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fcurve2d.png" alt="curve2d-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fcurve2d.png" alt="curve2d-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fcurve2d.png" alt="curve2d-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fcurve2d.png" alt="curve2d-pacmap"></td>
</tr>
<tr class="even">
<td align="center">mammoth</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fmammoth.png" alt="mammoth-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fmammoth.png" alt="mammoth-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fmammoth.png" alt="mammoth-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fmammoth.png" alt="mammoth-pacmap"></td>
</tr>
<tr class="odd">
<td align="center">scurvehole</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fscurvehole.png" alt="scurvehole-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fscurvehole.png" alt="scurvehole-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fscurvehole.png" alt="scurvehole-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fscurvehole.png" alt="scurvehole-pacmap"></td>
</tr>
<tr class="even">
<td align="center">isoswiss</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fisoswiss.png" alt="isoswiss-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fisoswiss.png" alt="isoswiss-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fisoswiss.png" alt="isoswiss-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fisoswiss.png" alt="isoswiss-pacmap"></td>
</tr>
<tr class="odd">
<td align="center">hierarchical</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fhierarchical.png" alt="hierarchical-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fhierarchical.png" alt="hierarchical-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fhierarchical.png" alt="hierarchical-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fhierarchical.png" alt="hierarchical-pacmap"></td>
</tr>
<tr class="even">
<td align="center">spheres</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fspheres.png" alt="spheres-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fspheres.png" alt="spheres-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fspheres.png" alt="spheres-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fspheres.png" alt="spheres-pacmap"></td>
</tr>
<tr class="odd">
<td align="center">coil20</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fcoil20.png" alt="coil20-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fcoil20.png" alt="coil20-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fcoil20.png" alt="coil20-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fcoil20.png" alt="coil20-pacmap"></td>
</tr>
<tr class="even">
<td align="center">coil100</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fcoil100.png" alt="coil100-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fcoil100.png" alt="coil100-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fcoil100.png" alt="coil100-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fcoil100.png" alt="coil100-pacmap"></td>
</tr>
<tr class="odd">
<td align="center">macosko2015</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fmacosko2015.png" alt="macosko2015-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fmacosko2015.png" alt="macosko2015-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fmacosko2015.png" alt="macosko2015-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fmacosko2015.png" alt="macosko2015-pacmap"></td>
</tr>
<tr class="even">
<td align="center">mnist</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fmnist.png" alt="mnist-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fmnist.png" alt="mnist-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fmnist.png" alt="mnist-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fmnist.png" alt="mnist-pacmap"></td>
</tr>
<tr class="odd">
<td align="center">fashion</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Ffashion.png" alt="fashion-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Ffashion.png" alt="fashion-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Ffashion.png" alt="fashion-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Ffashion.png" alt="fashion-pacmap"></td>
</tr>
<tr class="even">
<td align="center">ng20pacmap</td>
<td><img src="img%2Fpacmap-comparison%2Fumap%2Fng20pacmap.png" alt="ng20pacmap-umap"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca%2Fng20pacmap.png" alt="ng20pacmap-umap-pca"></td>
<td><img src="img%2Fpacmap-comparison%2Fumap-pca100%2Fng20pacmap.png" alt="ng20pacmap-umap-pca100"></td>
<td><img src="img%2Fpacmap-comparison%2Fpacmap%2Fng20pacmap.png" alt="ng20pacmap-pacmap"></td>
</tr>
</tbody>
</table>
<p>Headline results from my point of view are that going from left to
right, UMAP results get more like PaCMAP. But in <em>many</em> cases the
default UMAP results don’t seem that different to the PaCMAP results. In
a lot of these datasets, where there are differences, they have already
been discussed at length in the PaCMAP paper, but in act of enormous ego
I will provide my own commentary, you lucky things.</p>
<p>UMAP certainly makes<code>curve2d</code> a lot twistier than PaCMAP.
And <code>mammoth</code> looks very different. It’s been brutally
spatchcocked by UMAP, but it’s not been ripped to shreds. However, it’s
undeniable that the human eye definitely perceives the side-on view that
PaCMAP provides as being more “natural”. Also <code>scurvehole</code>
demonstrates that UMAP has a tendency to rip low-dimensional manifolds
more than PaCMAP. That said this dataset does often get ripped by PaCMAP
too (both the ends and – less often – the area around the hold can be
ripped), although the degree of ripping is not as pronounced as for
UMAP.</p>
<p>Let’s also look at <code>isoswiss</code>. Here UMAP is
<em>better</em> than PaCMAP and does a good job at nearly unfolding it.
It’s a bit hard to see what PaCMAP has done here, but it’s undone by the
PCA initialization which keeps the data rolled up. There has been some
unrolling, but it’s tough to ask a method that works on iteratively
updating pairs of points to do the large scale rearrangement of
unfolding, and instead the top part of the embedding has been
ripped.</p>
<p>You can see the same thing happening to a lesser extent with
<code>scurvehole</code> where the two ends are a bit twisted. This is
the same issue with a PCA initialization not being local enough. Is it
the end of the world? No. It’s just a bit of a shame we have to
sacrifice unfolding of these manifold examples given that the “M” in
PaCMAP also stands for “manifold”.</p>
<p>But these are all low-dimensional datasets. I would love to see
methods that could adapt to the intrinsic dimensionality of the data
they are working on, and PaCMAP’s gentler approach is definitely
superior here. But I am not sure that these are representative of the
kind of data that people are actually working with. And whether there
are lots of nice low-dimensional manifolds out there waiting to be
unfolded is an open question. If not, then PCA is a good enough
initialization for most datasets.</p>
<p>I’ll also briefly note something a bit odd about
<code>spheres</code>. Neither UMAP nor PaCMAP do a good job at
recognizing that the ten clusters are embedded in a larger sphere.
Perhaps not surprising due to the local nature of these methods. But
while UMAP gives a result with ten clusters, representing the ten
spheres, plus the points from the other cluster that were most local to
them, PaCMAP has <em>eleven</em> clusters. There is a large blob off to
the side that seems to be just the background cluster. Interesting, and
maybe you might like this result better due to it detecting the other
sphere, even if the “containment” relationship hasn’t been preserved.
However, I have seen artifactual behavior with Annoy sometimes when
there are lots of degenerate distances and the parameters haven’t been
set correctly. So there is a possibility that this is an artifact of the
nearest neighbor method having some issues. That would be something to
rule out but I haven’t done that here.</p>
<p><code>coil100</code> is an interesting case and is why I think the
“multiply the PCA coordinates by 0.01” approach of PaCMAP may give
slightly inconsistent initialization on occasion. UMAP gives a
circular-looking result, whereas PaCMAP is more elongated, with some of
the circular structures noticeably above or to the right of the body of
the embedding. This is a case where the PaCMAP result is very influenced
by the PCA initialization: the overall extent of the initialization is
quite a large value: the side length of the bounding box of the
initialized coordinates is around ~200 units vs ~30 for the PCA
initialization of <code>mnist</code>. This leads to large interpoint
distances which is the enemy of all SNE-like methods: the gradients are
smaller than usual and hence more of the initial structure is kept. This
could be seen as a good thing, because you might want to keep more of
the PCA-inspired layout and focus more on local optimization. However,
it’s not something that happens consistently with PaCMAP, it really
depends on the initial scaling of the input dataset. Having a better
scaling of the input coordinates would help here, such as the UMAP
approach of scaling the coordinates to a cube of length 10.</p>
<p>Of the other datasets, the one that stands out as most different
between UMAP and PaCMAP to my eyes is <code>macosko2015</code>. The
PaCMAP result looks much nicer here. I like this dataset because results
are very affected by PCA.</p>
<p>Now let’s see what using PCA initialization does to UMAP. The obvious
place to look is at <code>mammoth</code> and here we see that the
results are now much closer to PaCMAP’s. The same is true for
<code>curve2d</code> and <code>isoswiss</code>. <code>scurvehole</code>
also has an overall layout much closer to PaCMAP, but the degree of
twisting and ripping is definitely worse for UMAP.</p>
<p>Elsewhere, things aren’t changed so much. I admit I am a bit annoyed
by the result for <code>coil20</code> where one ring on the left is now
stuck inside a larger ring which isn’t the case for the spectral
initialization of PaCMAP but I will get over it. The UMAP + PCA result
for <code>coil100</code> also has the same circular shape as with the
spectral initialization rather than the elongated shape of the PaCMAP
result which I argue is further evidence that more control over the
initial scaling of PaCMAP could be helpful.</p>
<p>I also would say that in terms of overall layout, whether the
<code>mnist</code> cluster layout for UMAP or UMAP+PCA is more like the
PaCMAP result is a bit of a toss-up. But how well these methods work on
<code>mnist</code> is the last thing anyone should worry about. That
really leaves <code>macosko2015</code> whch still bears little
resemblance to the PaCMAP result.</p>
<p>In the third column we use PCA to reduce the initial dimensionality
of the data to 100 <em>and</em> we use the first two principal
components as the initial coordinates. This will only give a difference
in results compared to the UMAP+PCA results if the input data has more
than 100 columns, which is not the case for most of the datasets at the
top of the table. Further down not much happens <em>except</em> for
<code>macosko2015</code>, which now looks much more like the PaCMAP
results. This was not terribly surprising to me because I know that this
dataset is highly affected by running PCA on it first.</p>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>If you want a more PaCMAP-like experience out of <code>uwot</code>
using <code>pca = 100, init = "pca"</code> is a good way to go. Even for
lower-dimensional synthetic data, PCA will give you results closer to
PaCMAP, although they may look a bit more raggedy.</p>
<div class="section level3">
<h3 id="what-about-random-initialization">What about random initialization?<a class="anchor" aria-label="anchor" href="#what-about-random-initialization"></a>
</h3>
<p>One of PaCMAP’s selling points is that you will get more consistent
results even if you don’t use PCA for initialization. I will grant you
that this is certainly a point in PaCMAP’s favor. But on the other hand,
there’s a limited number of circumstances where you can’t just use PCA
for initialization. The PaCMAP paper doesn’t go into detail about what
these circumstances are, so I will just give you some of my ideas. The
main one might be that you have data which doesn’t really lend itself to
PCA. Probably binary data is the most obvious case here, although PaCMAP
only supports the Hamming distance for binary data so your options are a
bit limited anyway. Another example might be where the data is such that
you have access to the k-nearest neighbors but not the underlying
ambient data. But in that case, you would not be able to generate the
mid-near pairs needed for PaCMAP’s performance so you would be out of
luck anyway.</p>
<p>However, I am sure other scenarios exist. In those cases, PaCMAP is a
good choice. For other cases we can make UMAP do what we want in
<code>uwot</code> easily enough.</p>
</div>
<div class="section level3">
<h3 id="ok-but-will-it-be-as-fast">Ok, but will it be as fast?<a class="anchor" aria-label="anchor" href="#ok-but-will-it-be-as-fast"></a>
</h3>
<p>The bottleneck for most of these methods is the speed of the nearest
neighbor search which is in turn dependent on the input dimensionality.
So if the PCA process is sufficiently fast then the overall speed of the
PaCMAP approach will outperform the UMAP approach. In <code>uwot</code>
I find that <code>irlba</code> tends to be a bit slower than the
truncated SVD available in <code>sklearn</code> in Python as used by
PaCMAP but it depends on the linear algebra library on your system.</p>
<p>Due to some other internal differences, I would still anticipate that
PaCMAP will be a bit faster than UMAP under these conditions. In
practice, the difference isn’t that large in my experience (a few
seconds for <code>mnist</code>, for example). If speed matters to you
then I recommend using:</p>
<ul>
<li>
<code>a = 1, b = 1</code> with <code>umap2</code> if you don’t mind
a t-UMAP-like appearance.</li>
<li>Or use <code>approx_pow = TRUE</code> if you do want to control
<code>min_dist</code> and <code>spread</code> (or <code>a</code> and
<code>b</code> directly).</li>
<li>
<code>negative_sample_rate = 4</code> will reduce the amount of
negative sampling in line with what PaCMAP effectively does and
shouldn’t affect things too much.</li>
<li>consider using <code>rng_type = "deterministic"</code>, which will
not use a random number generator at all for the negative sampling. If
you want pseudo-random sampling, then
<code>rng_type = "tausworthe"</code> is faster than the default.</li>
</ul>
<p>On the other hand, if speed really matters, then PaCMAP will give you
vital seconds back without having to fiddle with the UMAP defaults.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Melville.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
